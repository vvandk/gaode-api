import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-b07c8c79.js";import{u as a,_ as t,a as l}from"./RightToolbar.vue_vue_type_script_setup_true_lang-44d08f8c.js";import{a0 as s,e as i,P as o,G as r,r as u,w as n,K as m,aa as p,o as d,l as c,m as _,x as v,k as y,y as f,D as g,ab as j,z as h,a6 as w}from"./index-dc787e95.js";import{c as k,s as b,_ as x}from"./Write.vue_vue_type_script_setup_true_lang-3caf29d8.js";import{a as R,E as z}from"./el-col-8a867eaa.js";import{E as D}from"./el-button-adf54e9f.js";import{E as C}from"./el-switch-54b2e8b0.js";import{_ as L}from"./Search.vue_vue_type_script_setup_true_lang-d97129cd.js";import{_ as S}from"./Dialog.vue_vue_type_style_index_0_lang-62a93a72.js";import{u as U}from"./dict-37e95629.js";import{s as V}from"./dict-ab5a6743.js";import"./el-card-4ec964b4.js";import"./el-popper-06627937.js";import"./use-form-common-props-e92a1987.js";import"./el-popover-85004fb7.js";import"./el-checkbox-8998332c.js";import"./event-5568c9d8.js";import"./use-form-item-cb2ecb0c.js";import"./el-divider-7e837124.js";import"./useForm-0cf5fadd.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./index-7a6ce827.js";import"./index-2bc17c13.js";import"./el-overlay-9a40cbcb.js";import"./vnode-7d8ea85e.js";import"./el-dropdown-item-978ba092.js";import"./useValidator-ce35917e.js";import"./use-dialog-30a6a371.js";import"./dict-416d98d1.js";const A=e=>s.get({url:"/sadmin/amap/keys",params:e}),P=e=>s.delete({url:"/sadmin/amap/keys",data:e}),E={class:"mb-8px flex justify-between"},F=i({name:"AmapKey",setup(i){const{wsCache:F}=o(),{t:G}=r(),{register:O,elTableRef:W,tableObject:$,methods:K}=a({getListApi:A,delListApi:P,response:{data:"data",count:"count"}}),{getList:T,setSearchParams:J}=K,N=u("default");n(N,(e=>{N.value=e}));const{currentRoute:Q}=m(),X=Q.value.fullPath;n(k,(async e=>{var a;F.set(X,JSON.stringify(e)),await p(),null==(a=W.value)||a.doLayout()}),{deep:!0});const Y=u();(async()=>{const e=U(),a=await e.getDictObj(["sys_sadmin_amap_auth_method"]);Y.value=a.sys_sadmin_amap_auth_method})();const Z=u(!1),q=u(""),B=u(""),H=u(!1),I=()=>{q.value=G("exampleDemo.add"),$.currentRow=null,Z.value=!0,B.value="add"},M=async e=>{const a=await(t=e.id,s.get({url:`/sadmin/amap/keys/${t}`}));var t;a&&(q.value="编辑",$.currentRow=a.data,Z.value=!0,B.value="edit")},ee=u(),ae=async()=>{var e;const a=y(ee);await(null==(e=null==a?void 0:a.elFormRef)?void 0:e.validate((async e=>{if(e){H.value=!0;let e=await(null==a?void 0:a.getFormData());if(!e)return H.value=!1,w.error("未获取到数据");try{const a=u({});"add"===B.value?(a.value=await(e=>s.post({url:"/sadmin/amap/keys",data:e}))(e),a.value&&(Z.value=!1,T())):"edit"===B.value&&(a.value=await(e=>s.put({url:`/sadmin/amap/keys/${e.id}`,data:e}))(e),a.value&&(Z.value=!1,T()))}finally{H.value=!1}}})))};return T(),(a,s)=>(d(),c(y(e),null,{default:_((()=>[v(y(L),{schema:y(b),onSearch:y(J),onReset:y(J)},null,8,["schema","onSearch","onReset"]),f("div",E,[v(y(R),null,{default:_((()=>[v(y(z),{span:1.5},{default:_((()=>[v(y(D),{type:"primary",onClick:I},{default:_((()=>[g("新增key")])),_:1})])),_:1})])),_:1}),v(y(t),{onGetList:y(T),"table-size":N.value,"onUpdate:tableSize":s[0]||(s[0]=e=>N.value=e),columns:y(k),"onUpdate:columns":s[1]||(s[1]=e=>j(k)?k.value=e:null),"cache-table-headers-key":y(X)},null,8,["onGetList","table-size","columns","cache-table-headers-key"])]),v(y(l),{limit:y($).limit,"onUpdate:limit":s[2]||(s[2]=e=>y($).limit=e),page:y($).page,"onUpdate:page":s[3]||(s[3]=e=>y($).page=e),columns:y(k),data:y($).tableData,loading:y($).loading,selection:!1,size:N.value,border:!0,pagination:{total:y($).count},onRegister:y(O)},{auth_method:_((({row:e})=>[f("span",null,h(y(V)(Y.value,e.auth_method)),1)])),is_active:_((({row:e})=>[v(y(C),{value:e.is_active,size:"small",disabled:""},null,8,["value"])])),is_auth:_((({row:e})=>[v(y(C),{value:e.is_auth,size:"small",disabled:""},null,8,["value"])])),action:_((({row:e})=>[v(y(D),{type:"primary",link:"",size:"small",onClick:a=>M(e)},{default:_((()=>[g(h(y(G)("exampleDemo.edit")),1)])),_:2},1032,["onClick"]),v(y(D),{type:"danger",link:"",size:"small",onClick:a=>(async e=>{const{delListApi:a}=K;await a(!0,[e.id])})(e)},{default:_((()=>[g(h(y(G)("exampleDemo.del")),1)])),_:2},1032,["onClick"])])),_:1},8,["limit","page","columns","data","loading","size","pagination","onRegister"]),v(y(S),{modelValue:Z.value,"onUpdate:modelValue":s[5]||(s[5]=e=>Z.value=e),title:q.value,width:"700px",height:"600px"},{footer:_((()=>[v(y(D),{type:"primary",loading:H.value,onClick:ae},{default:_((()=>[g(h(y(G)("exampleDemo.save")),1)])),_:1},8,["loading"]),v(y(D),{onClick:s[4]||(s[4]=e=>Z.value=!1)},{default:_((()=>[g(h(y(G)("dialogDemo.close")),1)])),_:1})])),default:_((()=>[v(x,{ref_key:"writeRef",ref:ee,"current-row":y($).currentRow},null,8,["current-row"])])),_:1},8,["modelValue","title"])])),_:1}))}});export{F as default};
