import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-b07c8c79.js";import{u as a,_ as t,a as l}from"./RightToolbar.vue_vue_type_script_setup_true_lang-44d08f8c.js";import{e as s,f as o,h as i,i as r,j as u}from"./issue-fd8ae597.js";import{c as n,s as p,_ as m}from"./Write.vue_vue_type_script_setup_true_lang-94c2d2b1.js";import{e as d,P as c,G as v,r as _,w as f,K as j,aa as y,o as g,l as h,m as w,x as b,k,y as x,D as R,ab as z,z as C}from"./index-dc787e95.js";import{a as D,E as L}from"./el-col-8a867eaa.js";import{E as S}from"./el-button-adf54e9f.js";import{E as P}from"./el-switch-54b2e8b0.js";import{u as U}from"./dict-37e95629.js";import{s as V}from"./dict-ab5a6743.js";import{_ as A}from"./Search.vue_vue_type_script_setup_true_lang-d97129cd.js";import{_ as E}from"./Dialog.vue_vue_type_style_index_0_lang-62a93a72.js";import"./el-card-4ec964b4.js";import"./el-popper-06627937.js";import"./use-form-common-props-e92a1987.js";import"./el-popover-85004fb7.js";import"./el-checkbox-8998332c.js";import"./event-5568c9d8.js";import"./use-form-item-cb2ecb0c.js";import"./el-divider-7e837124.js";import"./useForm-0cf5fadd.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./index-7a6ce827.js";import"./index-2bc17c13.js";import"./el-overlay-9a40cbcb.js";import"./vnode-7d8ea85e.js";import"./el-dropdown-item-978ba092.js";import"./useValidator-ce35917e.js";import"./dict-416d98d1.js";import"./use-dialog-30a6a371.js";const F={class:"mb-8px flex justify-between"},G=d({name:"HelpIssue",setup(d){const{wsCache:G}=c(),{t:O}=v(),{register:W,elTableRef:T,tableObject:B,methods:H}=a({getListApi:s,delListApi:o,response:{data:"data",count:"count"}}),{getList:I,setSearchParams:J}=H,K=_("default");f(K,(e=>{K.value=e}));const N=j().currentRoute.value.fullPath;f(n,(async e=>{var a;G.set(N,JSON.stringify(e)),await y(),null==(a=T.value)||a.doLayout()}),{deep:!0});const Q=_(!1),X=_(""),Y=_(!1),Z=_(""),$=_([]),q=_([]);(async()=>{const e=U(),a=await e.getDictObj(["sys_vadmin_platform"]);$.value=a.sys_vadmin_platform,q.value.push({field:"platform",path:"componentProps.options",value:a.sys_vadmin_platform})})();const M=async()=>{X.value="新增类别",B.currentRow=null,Q.value=!0,Z.value="add"},ee=_(),ae=async()=>{var e;const a=k(ee);await(null==(e=null==a?void 0:a.elFormRef)?void 0:e.validate((async e=>{if(e){Y.value=!0;let e=await(null==a?void 0:a.getFormData());try{const a=_({});"add"===Z.value?(a.value=await r(e),a.value&&(Q.value=!1,I())):"edit"===Z.value&&(a.value=await u(e),a.value&&(Q.value=!1,I()))}finally{Y.value=!1}}})))};return I(),(a,s)=>(g(),h(k(e),null,{default:w((()=>[b(k(A),{schema:k(p),setSchemaList:q.value,onSearch:k(J),onReset:k(J)},null,8,["schema","setSchemaList","onSearch","onReset"]),x("div",F,[b(k(D),null,{default:w((()=>[b(k(L),{span:1.5},{default:w((()=>[b(k(S),{type:"primary",onClick:M},{default:w((()=>[R("新增类别")])),_:1})])),_:1})])),_:1}),b(k(t),{onGetList:k(I),"table-size":K.value,"onUpdate:tableSize":s[0]||(s[0]=e=>K.value=e),columns:k(n),"onUpdate:columns":s[1]||(s[1]=e=>z(n)?n.value=e:null),"cache-table-headers-key":k(N)},null,8,["onGetList","table-size","columns","cache-table-headers-key"])]),b(k(l),{limit:k(B).limit,"onUpdate:limit":s[2]||(s[2]=e=>k(B).limit=e),page:k(B).page,"onUpdate:page":s[3]||(s[3]=e=>k(B).page=e),columns:k(n),data:k(B).tableData,loading:k(B).loading,selection:!1,size:K.value,border:!0,pagination:{total:k(B).count},onRegister:k(W)},{is_active:w((({row:e})=>[b(k(P),{value:e.is_active,size:"small",disabled:""},null,8,["value"])])),platform:w((({row:e})=>[R(C(k(V)($.value,e.platform)),1)])),action:w((({row:e})=>[b(k(S),{type:"primary",link:"",size:"small",onClick:a=>(async e=>{const a=await i(e.id);a&&(X.value="编辑",B.currentRow=a.data,Q.value=!0,Z.value="edit")})(e)},{default:w((()=>[R(C(k(O)("exampleDemo.edit")),1)])),_:2},1032,["onClick"]),b(k(S),{type:"danger",link:"",size:"small",onClick:a=>(async e=>{const{delListApi:a}=H;await a(!0,[e.id])})(e)},{default:w((()=>[R(C(k(O)("exampleDemo.del")),1)])),_:2},1032,["onClick"])])),_:1},8,["limit","page","columns","data","loading","size","pagination","onRegister"]),b(k(E),{modelValue:Q.value,"onUpdate:modelValue":s[5]||(s[5]=e=>Q.value=e),title:X.value,width:"700px"},{footer:w((()=>[b(k(S),{type:"primary",loading:Y.value,onClick:ae},{default:w((()=>[R(C(k(O)("exampleDemo.save")),1)])),_:1},8,["loading"]),b(k(S),{onClick:s[4]||(s[4]=e=>Q.value=!1)},{default:w((()=>[R(C(k(O)("dialogDemo.close")),1)])),_:1})])),default:w((()=>[b(m,{ref_key:"writeRef",ref:ee,"current-row":k(B).currentRow,"platform-options":$.value},null,8,["current-row","platform-options"])])),_:1},8,["modelValue","title"])])),_:1}))}});export{G as default};
