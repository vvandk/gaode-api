import{S as e,bz as o,b6 as t,h as n,ab as s,az as a,u as l,d3 as r,b0 as i,bB as c,w as u,bn as d,bV as p,d4 as m,bU as f,b9 as v,aa as g,aI as y,b,d as h,e as C,x as E,q as x,br as w,_ as M,E as k,d5 as B,d6 as I,f as T,r as S,L as z,d7 as L,b4 as R,a8 as _,o as A,l as P,m as O,af as $,y as j,s as V,n as H,bf as Y,j as D,p as K,M as q,z as U,be as X,D as F,aO as W,C as Z,g as N,ay as G,d8 as J,by as Q,aw as ee,aK as oe,b5 as te,ca as ne}from"./index-dc787e95.js";import{E as se}from"./el-button-adf54e9f.js";import{d as ae,o as le,a as re}from"./el-divider-7e837124.js";import{P as ie}from"./vnode-7d8ea85e.js";import{d as ce}from"./el-popper-06627937.js";import{i as ue}from"./el-switch-54b2e8b0.js";import{b as de}from"./use-form-common-props-e92a1987.js";const pe=(s,a,l)=>{let r={offsetX:0,offsetY:0};const i=e=>{const o=e.clientX,t=e.clientY,{offsetX:a,offsetY:l}=r,i=s.value.getBoundingClientRect(),c=i.left,u=i.top,d=i.width,p=i.height,m=document.documentElement.clientWidth,f=document.documentElement.clientHeight,v=-c+a,g=-u+l,y=m-c-d+a,b=f-u-p+l,h=e=>{const i=Math.min(Math.max(a+e.clientX-o,v),y),c=Math.min(Math.max(l+e.clientY-t,g),b);r={offsetX:i,offsetY:c},s.value.style.transform=`translate(${n(i)}, ${n(c)})`},C=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",C)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",C)},c=()=>{a.value&&s.value&&a.value.removeEventListener("mousedown",i)};e((()=>{o((()=>{l.value?a.value&&s.value&&a.value.addEventListener("mousedown",i):c()}))})),t((()=>{c()}))},me=(e,o={})=>{s(e)||a("[useLockscreen]","You need to pass a ref param to this function");const t=o.ns||l("popup"),n=r((()=>t.bm("parent","hidden")));if(!i||c(document.body,n.value))return;let v=0,g=!1,y="0";const b=()=>{setTimeout((()=>{f(null==document?void 0:document.body,n.value),g&&document&&(document.body.style.width=y)}),200)};u(e,(e=>{if(!e)return void b();g=!c(document.body,n.value),g&&(y=document.body.style.width),v=ae(t.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,s=d(document.body,"overflowY");v>0&&(o||"scroll"===s)&&g&&(document.body.style.width=`calc(100% - ${v}px)`),p(document.body,n.value)})),m((()=>b()))},fe=e=>{if(!e)return{onClick:v,onMousedown:v,onMouseup:v};let o=!1,t=!1;return{onClick:n=>{o&&t&&e(n),o=t=!1},onMousedown:e=>{o=e.target===e.currentTarget},onMouseup:e=>{t=e.target===e.currentTarget}}},ve="_trap-focus-children",ge=[],ye=e=>{if(0===ge.length)return;const o=ge[ge.length-1][ve];if(o.length>0&&e.code===y.tab){if(1===o.length)return e.preventDefault(),void(document.activeElement!==o[0]&&o[0].focus());const t=e.shiftKey,n=e.target===o[0],s=e.target===o[o.length-1];n&&t&&(e.preventDefault(),o[o.length-1].focus()),s&&!t&&(e.preventDefault(),o[0].focus())}},be={beforeMount(e){e[ve]=le(e),ge.push(e),ge.length<=1&&document.addEventListener("keydown",ye)},updated(e){g((()=>{e[ve]=le(e)}))},unmounted(){ge.shift(),0===ge.length&&document.removeEventListener("keydown",ye)}},he=b({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:h([String,Array,Object])},zIndex:{type:h([String,Number])}});const Ce=C({name:"ElOverlay",props:he,emits:{click:e=>e instanceof MouseEvent},setup(e,{slots:o,emit:t}){const n=l("overlay"),{onClick:s,onMousedown:a,onMouseup:r}=fe(e.customMaskEvent?void 0:e=>{t("click",e)});return()=>e.mask?E("div",{class:[n.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:s,onMousedown:a,onMouseup:r},[x(o,"default")],ie.STYLE|ie.CLASS|ie.PROPS,["onClick","onMouseup","onMousedown"]):w("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[x(o,"default")])}}),Ee=C({name:"ElMessageBox",directives:{TrapFocus:be},components:{ElButton:se,ElFocusTrap:ce,ElInput:re,ElOverlay:Ce,ElIcon:k,...B},inheritAttrs:!1,props:{buttonSize:{type:String,validator:ue},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(o,{emit:n}){const{locale:s,zIndex:a,ns:l,size:r}=I("message-box",T((()=>o.buttonSize))),{t:i}=s,{nextZIndex:c}=a,d=S(!1),p=z({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:c()}),m=T((()=>{const e=p.type;return{[l.bm("icon",e)]:e&&L[e]}})),f=de(),v=de(),y=T((()=>p.icon||L[p.type]||"")),b=T((()=>!!p.message)),h=S(),C=S(),E=S(),x=S(),w=S(),M=T((()=>p.confirmButtonClass));u((()=>p.inputValue),(async e=>{await g(),"prompt"===o.boxType&&null!==e&&O()}),{immediate:!0}),u((()=>d.value),(e=>{var t,n;e&&("prompt"!==o.boxType&&(p.autofocus?E.value=null!=(n=null==(t=w.value)?void 0:t.$el)?n:h.value:E.value=h.value),p.zIndex=c()),"prompt"===o.boxType&&(e?g().then((()=>{var e;x.value&&x.value.$el&&(p.autofocus?E.value=null!=(e=$())?e:h.value:E.value=h.value)})):(p.editorErrorMessage="",p.validateError=!1))}));const k=T((()=>o.draggable));function B(){d.value&&(d.value=!1,g((()=>{p.action&&n("action",p.action)})))}pe(h,C,k),e((async()=>{await g(),o.closeOnHashChange&&window.addEventListener("hashchange",B)})),t((()=>{o.closeOnHashChange&&window.removeEventListener("hashchange",B)}));const _=()=>{o.closeOnClickModal&&P(p.distinguishCancelAndClose?"close":"cancel")},A=fe(_),P=e=>{var t;("prompt"!==o.boxType||"confirm"!==e||O())&&(p.action=e,p.beforeClose?null==(t=p.beforeClose)||t.call(p,e,p,B):B())},O=()=>{if("prompt"===o.boxType){const e=p.inputPattern;if(e&&!e.test(p.inputValue||""))return p.editorErrorMessage=p.inputErrorMessage||i("el.messagebox.error"),p.validateError=!0,!1;const o=p.inputValidator;if("function"==typeof o){const e=o(p.inputValue);if(!1===e)return p.editorErrorMessage=p.inputErrorMessage||i("el.messagebox.error"),p.validateError=!0,!1;if("string"==typeof e)return p.editorErrorMessage=e,p.validateError=!0,!1}}return p.editorErrorMessage="",p.validateError=!1,!0},$=()=>{const e=x.value.$refs;return e.input||e.textarea},j=()=>{P("close")};return o.lockScroll&&me(d),{...R(p),ns:l,overlayEvent:A,visible:d,hasMessage:b,typeClass:m,contentId:f,inputId:v,btnSize:r,iconComponent:y,confirmButtonClasses:M,rootRef:h,focusStartRef:E,headerRef:C,inputRef:x,confirmRef:w,doClose:B,handleClose:j,onCloseRequested:()=>{o.closeOnPressEscape&&j()},handleWrapperClick:_,handleInputEnter:e=>{if("textarea"!==p.inputType)return e.preventDefault(),P("confirm")},handleAction:P,t:i}}}),xe=["aria-label","aria-describedby"],we=["aria-label"],Me=["id"];var ke=M(Ee,[["render",function(e,o,t,n,s,a){const l=_("el-icon"),r=_("close"),i=_("el-input"),c=_("el-button"),u=_("el-focus-trap"),d=_("el-overlay");return A(),P(Z,{name:"fade-in-linear",onAfterLeave:o[11]||(o[11]=o=>e.$emit("vanish")),persisted:""},{default:O((()=>[$(E(d,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:O((()=>[j("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:V(`${e.ns.namespace.value}-overlay-message-box`),onClick:o[8]||(o[8]=(...o)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...o)),onMousedown:o[9]||(o[9]=(...o)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...o)),onMouseup:o[10]||(o[10]=(...o)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...o))},[E(u,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:O((()=>[j("div",{ref:"rootRef",class:V([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:H(e.customStyle),tabindex:"-1",onClick:o[7]||(o[7]=Y((()=>{}),["stop"]))},[null!==e.title&&void 0!==e.title?(A(),D("div",{key:0,ref:"headerRef",class:V(e.ns.e("header"))},[j("div",{class:V(e.ns.e("title"))},[e.iconComponent&&e.center?(A(),P(l,{key:0,class:V([e.ns.e("status"),e.typeClass])},{default:O((()=>[(A(),P(K(e.iconComponent)))])),_:1},8,["class"])):q("v-if",!0),j("span",null,U(e.title),1)],2),e.showClose?(A(),D("button",{key:0,type:"button",class:V(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:o[0]||(o[0]=o=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:o[1]||(o[1]=X(Y((o=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),["prevent"]),["enter"]))},[E(l,{class:V(e.ns.e("close"))},{default:O((()=>[E(r)])),_:1},8,["class"])],42,we)):q("v-if",!0)],2)):q("v-if",!0),j("div",{id:e.contentId,class:V(e.ns.e("content"))},[j("div",{class:V(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(A(),P(l,{key:0,class:V([e.ns.e("status"),e.typeClass])},{default:O((()=>[(A(),P(K(e.iconComponent)))])),_:1},8,["class"])):q("v-if",!0),e.hasMessage?(A(),D("div",{key:1,class:V(e.ns.e("message"))},[x(e.$slots,"default",{},(()=>[e.dangerouslyUseHTMLString?(A(),P(K(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(A(),P(K(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:O((()=>[F(U(e.dangerouslyUseHTMLString?"":e.message),1)])),_:1},8,["for"]))]))],2)):q("v-if",!0)],2),$(j("div",{class:V(e.ns.e("input"))},[E(i,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":o[2]||(o[2]=o=>e.inputValue=o),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:V({invalid:e.validateError}),onKeydown:X(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),j("div",{class:V(e.ns.e("errormsg")),style:H({visibility:e.editorErrorMessage?"visible":"hidden"})},U(e.editorErrorMessage),7)],2),[[W,e.showInput]])],10,Me),j("div",{class:V(e.ns.e("btns"))},[e.showCancelButton?(A(),P(c,{key:0,loading:e.cancelButtonLoading,class:V([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:o[3]||(o[3]=o=>e.handleAction("cancel")),onKeydown:o[4]||(o[4]=X(Y((o=>e.handleAction("cancel")),["prevent"]),["enter"]))},{default:O((()=>[F(U(e.cancelButtonText||e.t("el.messagebox.cancel")),1)])),_:1},8,["loading","class","round","size"])):q("v-if",!0),$(E(c,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,class:V([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:o[5]||(o[5]=o=>e.handleAction("confirm")),onKeydown:o[6]||(o[6]=X(Y((o=>e.handleAction("confirm")),["prevent"]),["enter"]))},{default:O((()=>[F(U(e.confirmButtonText||e.t("el.messagebox.confirm")),1)])),_:1},8,["loading","class","round","disabled","size"]),[[W,e.showConfirmButton]])],2)],6)])),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,xe)])),_:3},8,["z-index","overlay-class","mask"]),[[W,e.visible]])])),_:3})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const Be=new Map,Ie=(e,o,t=null)=>{const n=E(ke,e,te(e.message)||G(e.message)?{default:te(e.message)?e.message:()=>e.message}:null);return n.appContext=t,J(n,o),(e=>{let o=document.body;return e.appendTo&&(N(e.appendTo)&&(o=document.querySelector(e.appendTo)),ne(e.appendTo)&&(o=e.appendTo),ne(o)||(o=document.body)),o})(e).appendChild(o.firstElementChild),n.component},Te=(e,o)=>{const t=document.createElement("div");e.onVanish=()=>{J(null,t),Be.delete(s)},e.onAction=o=>{const t=Be.get(s);let a;a=e.showInput?{value:s.inputValue,action:o}:o,e.callback?e.callback(a,n.proxy):"cancel"===o||"close"===o?e.distinguishCancelAndClose&&"cancel"!==o?t.reject("close"):t.reject("cancel"):t.resolve(a)};const n=Ie(e,t,o),s=n.proxy;for(const a in e)Q(e,a)&&!Q(s.$props,a)&&(s[a]=e[a]);return s.visible=!0,s};function Se(e,o=null){if(!i)return Promise.reject();let t;return N(e)||G(e)?e={message:e}:t=e.callback,new Promise(((n,s)=>{const a=Te(e,null!=o?o:Se._context);Be.set(a,{options:e,callback:t,resolve:n,reject:s})}))}const ze={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};["alert","confirm","prompt"].forEach((e=>{Se[e]=function(e){return(o,t,n,s)=>{let a="";return ee(t)?(n=t,a=""):a=oe(t)?"":t,Se(Object.assign({title:a,message:o,type:"",...ze[e]},n,{boxType:e}),s)}}(e)})),Se.close=()=>{Be.forEach(((e,o)=>{o.doClose()})),Be.clear()},Se._context=null;const Le=Se;Le.install=e=>{Le._context=e._context,e.config.globalProperties.$msgbox=Le,e.config.globalProperties.$messageBox=Le,e.config.globalProperties.$alert=Le.alert,e.config.globalProperties.$confirm=Le.confirm,e.config.globalProperties.$prompt=Le.prompt};const Re=Le;export{Re as E,Ce as a,fe as b,me as c,pe as u};
