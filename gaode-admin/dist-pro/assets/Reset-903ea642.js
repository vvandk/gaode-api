import{u as e,F as s}from"./useForm-0cf5fadd.js";import{e as a,A as o,f as t,J as r,K as i,L as l,r as d,w as p,o as n,j as c,y as m,x as u,m as v,k as f,D as w,l as h,M as _,N as g,O as j,P as b,H as x,I as y}from"./index-dc787e95.js";import{E as R}from"./el-button-adf54e9f.js";import{u as P}from"./useValidator-ce35917e.js";import{_ as k}from"./Footer.vue_vue_type_script_setup_true_lang-6ffc0864.js";import{_ as F}from"./_plugin-vue_export-helper-1b428a4d.js";import"./el-col-8a867eaa.js";import"./el-popper-06627937.js";import"./use-form-common-props-e92a1987.js";import"./el-divider-7e837124.js";import"./event-5568c9d8.js";import"./use-form-item-cb2ecb0c.js";import"./el-checkbox-8998332c.js";import"./el-switch-54b2e8b0.js";import"./index-7a6ce827.js";import"./index-2bc17c13.js";const I={class:"main-container"},q={class:"form-container"},A=(e=>(x("data-v-96b350f0"),e=e(),y(),e))((()=>m("h2",{class:"text-2xl font-bold text-center w-[100%]"},"第一次登录系统，需先重置密码",-1))),C={class:"w-[100%]"},D={class:"footer-container"},E=F(a({__name:"Reset",setup(a){const x=o(),{required:y}=P(),F=t((()=>x.getFooter)),E=r(),{addRoute:z,push:H,currentRoute:J}=i(),K={password:[y(),{min:8,max:16,message:"长度需为8-16个字符,请重新输入。",trigger:"blur"}],password_two:[y(),{min:8,max:16,message:"长度需为8-16个字符,请重新输入。",trigger:"blur"}]},L=l([{field:"title",colProps:{span:24}},{field:"password",label:"新密码",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:"请输入新密码"}},{field:"password_two",label:"再次输入新密码",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:"请再次输入新密码"}},{field:"reset",colProps:{span:24}}]),{register:M,elFormRef:N,methods:O}=e(),Q=d(!1),V=d("");p((()=>J.value),(e=>{var s;V.value=null==(s=null==e?void 0:e.query)?void 0:s.redirect}),{immediate:!0});const X=async()=>{const e=f(N);await(null==e?void 0:e.validate((async e=>{if(e){Q.value=!0;const{getFormData:e}=O,a=await e();try{await g(a)?Y():Q.value=!1}catch(s){Q.value=!1}}})))},Y=async()=>{const e=await j();if(e){const{wsCache:s}=b(),a=e.data||[];s.set("roleRouters",a),await E.generateRoutes(a).catch((()=>{})),E.getAddRouters.forEach((e=>{z(e)})),E.setIsAddRouters(!0),H({path:V.value||E.addRouters[0].path})}};return(e,a)=>(n(),c("div",I,[m("div",q,[u(f(s),{schema:L,rules:K,"label-position":"top","hide-required-asterisk":"",size:"large",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid",onRegister:f(M)},{title:v((()=>[A])),reset:v((()=>[m("div",C,[u(f(R),{loading:Q.value,type:"primary",class:"w-[100%]",onClick:X},{default:v((()=>[w(" 重置密码 ")])),_:1},8,["loading"])])])),_:1},8,["schema","onRegister"])]),m("div",D,[F.value?(n(),h(f(k),{key:0})):_("",!0)])]))}}),[["__scopeId","data-v-96b350f0"]]);export{E as default};
