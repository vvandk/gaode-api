import{u as e,E as l,F as a}from"./useForm-0cf5fadd.js";import{u as o}from"./useValidator-ce35917e.js";import{c as s}from"./menu-49936113.js";import{L as t,e as n,G as d,w as r,r as p,o as i,l as c,m as u,y as m,x as b,k as f,ab as h,z as v}from"./index-dc787e95.js";import{E as y}from"./el-checkbox-8998332c.js";const w=t([{field:"id",label:"角色编号",show:!0,disabled:!0},{field:"name",label:"角色名称",show:!0,disabled:!0},{field:"role_key",label:"权限字符",show:!0},{field:"order",label:"显示顺序",show:!0},{field:"disabled",label:"角色状态",show:!0},{field:"is_admin",label:"最高权限",show:!0},{field:"create_datetime",label:"创建时间",show:!0},{field:"action",width:"150px",label:"操作",show:!0}]),k=t([{field:"name",label:"角色名称",colProps:{span:12},component:"Input"},{field:"role_key",label:"权限字符",colProps:{span:12},component:"Input"},{field:"disabled",label:"角色状态",colProps:{span:12},component:"Radio",componentProps:{style:{width:"100%"},options:[{label:"正常",value:!1},{label:"禁用",value:!0}]},value:!1},{field:"is_admin",label:"最高权限",colProps:{span:12},component:"Radio",componentProps:{style:{width:"100%"},options:[{label:"使用",value:!0},{label:"不使用",value:!1}]},value:!1},{field:"order",label:"显示排序",colProps:{span:12},component:"InputNumber",componentProps:{style:{width:"100%"}}},{field:"desc",label:"描述",colProps:{span:12},component:"Input"},{field:"menu_ids",label:"菜单权限",colProps:{span:24}}]),x=t([{field:"name",label:"角色名称",component:"Input",componentProps:{clearable:!1,style:{width:"214px"}}},{field:"role_key",label:"权限字符",component:"Input",componentProps:{clearable:!1,style:{width:"214px"}}},{field:"disabled",label:"状态",component:"Select",componentProps:{style:{width:"214px"},options:[{label:"正常",value:!1},{label:"停用",value:!0}]}}]),_={class:"max-h-390px border p-10px overflow-auto"},g=n({__name:"Write",props:{currentRow:{type:Object,default:()=>null},defaultCheckedKeys:{type:Array,default:()=>[]}},setup(n,{expose:w}){const x=n,{required:g}=o(),{t:P}=d(),R=t({name:[g()],role_key:[g()],order:[g()]}),{register:V,methods:C,elFormRef:j}=e({schema:k});r((()=>x.currentRow),(e=>{if(!e)return;const{setValues:l}=C;l(e)}),{deep:!0,immediate:!0});const F={children:"children",label:"label"};let I=p([]);(async()=>{const e=await s();e&&(I.value=e.data)})();const K=p();w({elFormRef:j,getFormData:C.getFormData,getTreeCheckedKeys:()=>K.value.getCheckedKeys(!1)});let z=p(!1),D=p(!0),E=p(!1);const U=e=>{let l=[];for(let a=0;a<e.length;a++)l.push(e[a].value),e[a].children&&e[a].children.length>0&&(l=l.concat(U(e[a].children)));return l},q=()=>{for(let e=0;e<I.value.length;e++)K.value.store.nodesMap[I.value[e].value].expanded=D.value};function A(){K.value.setCheckedKeys(z.value?U(I.value):[])}return(e,o)=>(i(),c(f(a),{rules:R,onRegister:f(V)},{menu_ids:u((()=>[m("div",null,[m("div",null,[b(f(y),{modelValue:f(D),"onUpdate:modelValue":o[0]||(o[0]=e=>h(D)?D.value=e:D=e),onChange:q,label:"展开/折叠",size:"large"},null,8,["modelValue"]),b(f(y),{modelValue:f(z),"onUpdate:modelValue":o[1]||(o[1]=e=>h(z)?z.value=e:z=e),onChange:A,label:"全选/全不选",size:"large"},null,8,["modelValue"])]),m("div",_,[b(f(l),{ref_key:"treeRef",ref:K,data:f(I),"show-checkbox":"","node-key":"value",props:F,"default-expand-all":f(D),"check-strictly":!f(E),"default-checked-keys":n.defaultCheckedKeys},{default:u((({node:e})=>[m("span",null,v(f(P)(e.label)),1)])),_:1},8,["data","default-expand-all","check-strictly","default-checked-keys"])])])])),_:1},8,["rules","onRegister"]))}});export{g as _,w as c,x as s};
