import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-b07c8c79.js";import{u as a,_ as t,a as l}from"./RightToolbar.vue_vue_type_script_setup_true_lang-44d08f8c.js";import{g as s,d as o,a as i,b as r,p as u}from"./role-f1df7e15.js";import{e as n,P as d,G as p,r as m,w as c,K as v,aa as _,ae as f,o as g,l as y,m as j,x as h,k,y as w,af as b,D as x,ab as R,z as C,M as D,a6 as z}from"./index-dc787e95.js";import{E as L}from"./el-button-adf54e9f.js";import{E as S}from"./el-switch-54b2e8b0.js";import{a as P,E as U}from"./el-col-8a867eaa.js";import{c as A,s as V,_ as E}from"./Write.vue_vue_type_script_setup_true_lang-caeef819.js";import{_ as F}from"./Dialog.vue_vue_type_style_index_0_lang-62a93a72.js";import{_ as G}from"./Search.vue_vue_type_script_setup_true_lang-d97129cd.js";import"./el-card-4ec964b4.js";import"./el-popper-06627937.js";import"./use-form-common-props-e92a1987.js";import"./el-popover-85004fb7.js";import"./el-checkbox-8998332c.js";import"./event-5568c9d8.js";import"./use-form-item-cb2ecb0c.js";import"./el-divider-7e837124.js";import"./useForm-0cf5fadd.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./index-7a6ce827.js";import"./index-2bc17c13.js";import"./el-overlay-9a40cbcb.js";import"./vnode-7d8ea85e.js";import"./el-dropdown-item-978ba092.js";import"./useValidator-ce35917e.js";import"./menu-49936113.js";import"./use-dialog-30a6a371.js";const T={class:"mb-8px flex justify-between"},K=n({name:"AuthRole",setup(n){const{wsCache:K}=d(),{t:O}=p(),{register:W,elTableRef:q,tableObject:J,methods:M}=a({getListApi:s,delListApi:o,response:{data:"data",count:"count"}}),N=m(!1),Q=m(""),X=m(""),Y=m(!1),Z=m([]),$=()=>{Q.value=O("exampleDemo.add"),J.currentRow=null,N.value=!0,X.value="add",Z.value=[]},B=m(),H=async()=>{var e;const a=k(B);await(null==(e=null==a?void 0:a.elFormRef)?void 0:e.validate((async e=>{if(e){Y.value=!0;let e=await(null==a?void 0:a.getFormData());if(!e)return Y.value=!1,z.error("未获取到数据");e.menu_ids=null==a?void 0:a.getTreeCheckedKeys();try{const a=m({});"add"===X.value?(a.value=await r(e),a.value&&(N.value=!1,I())):"edit"===X.value&&(a.value=await u(e),a.value&&(N.value=!1,I()))}finally{Y.value=!1}}})))},{getList:I,setSearchParams:ee}=M;I();const ae=m("default");c(ae,(e=>{ae.value=e}));const te=v().currentRoute.value.fullPath;return c(A,(async e=>{var a;K.set(te,JSON.stringify(e)),await _(),null==(a=q.value)||a.doLayout()}),{deep:!0}),(a,s)=>{const o=f("hasPermi");return g(),y(k(e),null,{default:j((()=>[h(k(G),{schema:k(V),onSearch:k(ee),onReset:k(ee)},null,8,["schema","onSearch","onReset"]),w("div",T,[h(k(P),{gutter:10},{default:j((()=>[b((g(),y(k(U),{span:1.5},{default:j((()=>[h(k(L),{type:"primary",onClick:$},{default:j((()=>[x("新增角色")])),_:1})])),_:1})),[[o,["auth.role.create"]]])])),_:1}),h(k(t),{onGetList:k(I),"table-size":ae.value,"onUpdate:tableSize":s[0]||(s[0]=e=>ae.value=e),columns:k(A),"onUpdate:columns":s[1]||(s[1]=e=>R(A)?A.value=e:null),"cache-table-headers-key":k(te)},null,8,["onGetList","table-size","columns","cache-table-headers-key"])]),h(k(l),{limit:k(J).limit,"onUpdate:limit":s[2]||(s[2]=e=>k(J).limit=e),page:k(J).page,"onUpdate:page":s[3]||(s[3]=e=>k(J).page=e),data:k(J).tableData,loading:k(J).loading,columns:k(A),size:ae.value,border:!0,selection:!1,pagination:{total:k(J).count},onRegister:k(W)},{action:j((({row:e})=>[1!==e.id?b((g(),y(k(L),{key:0,type:"primary",link:"",size:"small",onClick:a=>(async e=>{const a=await i(e.id);a&&(Q.value="编辑",J.currentRow=a.data,Z.value=a.data.menus.map((e=>e.id)),N.value=!0,X.value="edit")})(e)},{default:j((()=>[x(C(k(O)("exampleDemo.edit")),1)])),_:2},1032,["onClick"])),[[o,["auth.role.update"]]]):D("",!0),1!==e.id?b((g(),y(k(L),{key:1,type:"danger",link:"",size:"small",onClick:a=>(async e=>{const{delListApi:a}=M;await a(!0,[e.id])})(e)},{default:j((()=>[x(C(k(O)("exampleDemo.del")),1)])),_:2},1032,["onClick"])),[[o,["auth.role.delete"]]]):D("",!0)])),disabled:j((({row:e})=>[h(k(S),{value:!e.disabled,disabled:""},null,8,["value"])])),is_admin:j((({row:e})=>[h(k(S),{value:e.is_admin,disabled:""},null,8,["value"])])),_:1},8,["limit","page","data","loading","columns","size","pagination","onRegister"]),h(k(F),{modelValue:N.value,"onUpdate:modelValue":s[5]||(s[5]=e=>N.value=e),title:Q.value,width:"700px",height:"600px"},{footer:j((()=>[h(k(L),{type:"primary",loading:Y.value,onClick:H},{default:j((()=>[x(C(k(O)("exampleDemo.save")),1)])),_:1},8,["loading"]),h(k(L),{onClick:s[4]||(s[4]=e=>N.value=!1)},{default:j((()=>[x(C(k(O)("dialogDemo.close")),1)])),_:1})])),default:j((()=>[h(E,{ref_key:"writeRef",ref:B,"current-row":k(J).currentRow,"default-checked-keys":Z.value},null,8,["current-row","default-checked-keys"])])),_:1},8,["modelValue","title"])])),_:1})}}});export{K as default};
